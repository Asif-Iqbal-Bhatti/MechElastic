

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mechelastic.core.ELATE &mdash; MechElastic  documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home" alt="Documentation Home"> MechElastic
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">MechElastic API</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">MechElastic</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>mechelastic.core.ELATE</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for mechelastic.core.ELATE</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">platform</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>


<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Romain Gaillac and Fran√ßois-Xavier Coudert&quot;</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;2019.01.09&quot;</span>
<span class="n">__license__</span> <span class="o">=</span> <span class="s2">&quot;MIT&quot;</span>


<div class="viewcode-block" id="make3DPlot"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.make3DPlot">[docs]</a><span class="k">def</span> <span class="nf">make3DPlot</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">npoints</span><span class="o">=</span><span class="mi">200</span><span class="p">):</span>

    <span class="n">str1</span> <span class="o">=</span> <span class="n">legend</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">str2</span> <span class="o">=</span> <span class="n">legend</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">npoints</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">npoints</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>

    <span class="n">dataX</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>
    <span class="n">dataY</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>
    <span class="n">dataZ</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>
    <span class="n">dataR</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;0.0&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>

    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">cu</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">cv</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)):</span>
            <span class="n">r_tmp</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="n">cv</span><span class="p">])</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">r_tmp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">])</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">r_tmp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">cv</span><span class="p">])</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">r_tmp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">cv</span><span class="p">])</span>
            <span class="n">dataX</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
            <span class="n">dataY</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>
            <span class="n">dataZ</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span>
            <span class="n">dataR</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;&#39;E = &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">r_tmp</span><span class="p">))</span> <span class="o">/</span> <span class="mf">10.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot; GPa, &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u03B8</span><span class="s2"> = &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">]</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">/</span> <span class="mf">10.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u00B0</span><span class="s2">, &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u03c6</span><span class="s2"> = &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="n">cv</span><span class="p">]</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">/</span> <span class="mf">10.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u00B0</span><span class="s2">&#39;&quot;</span>
            <span class="p">)</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">dataX</span><span class="p">,</span> <span class="n">dataY</span><span class="p">,</span> <span class="n">dataZ</span><span class="p">,</span> <span class="n">dataR</span><span class="p">)</span></div>


<div class="viewcode-block" id="make3DPlotPosNeg"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.make3DPlotPosNeg">[docs]</a><span class="k">def</span> <span class="nf">make3DPlotPosNeg</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">npoints</span><span class="o">=</span><span class="mi">200</span><span class="p">):</span>

    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">npoints</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">npoints</span><span class="p">)</span>

    <span class="n">dataX1</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>
    <span class="n">dataY1</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>
    <span class="n">dataZ1</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>
    <span class="n">dataR1</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;0.0&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>

    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">cu</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">cv</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)):</span>
            <span class="n">r_tmp</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">func</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="n">cv</span><span class="p">]))</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">r_tmp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">])</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">r_tmp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">cv</span><span class="p">])</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">r_tmp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">cv</span><span class="p">])</span>
            <span class="n">dataX1</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
            <span class="n">dataY1</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>
            <span class="n">dataZ1</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span>
            <span class="n">dataR1</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;&#39;&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u03B2</span><span class="s2"> = &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">r_tmp</span><span class="p">))</span> <span class="o">/</span> <span class="mf">10.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot; TPa&#39;&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;+&#39;-1&#39;.sup()+&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;&#39;, </span><span class="se">\u03B8</span><span class="s2"> = &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">]</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">/</span> <span class="mf">10.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u00B0</span><span class="s2">, &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u03c6</span><span class="s2"> = &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="n">cv</span><span class="p">]</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">/</span> <span class="mf">10.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u00B0</span><span class="s2">&#39;&quot;</span>
            <span class="p">)</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="n">dataX2</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>
    <span class="n">dataY2</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>
    <span class="n">dataZ2</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>
    <span class="n">dataR2</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;0.0&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>

    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">cu</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">cv</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)):</span>
            <span class="n">r_tmp</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">func</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="n">cv</span><span class="p">]))</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">r_tmp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">])</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">r_tmp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">cv</span><span class="p">])</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">r_tmp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">cv</span><span class="p">])</span>
            <span class="n">dataX2</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
            <span class="n">dataY2</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>
            <span class="n">dataZ2</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span>
            <span class="n">dataR2</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;&#39;&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u03B2</span><span class="s2"> = -&quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">r_tmp</span><span class="p">))</span> <span class="o">/</span> <span class="mf">10.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot; TPa&#39;&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;+&#39;-1&#39;.sup()+&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;&#39;, </span><span class="se">\u03B8</span><span class="s2"> = &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">]</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">/</span> <span class="mf">10.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u00B0</span><span class="s2">, &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u03c6</span><span class="s2"> = &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="n">cv</span><span class="p">]</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">/</span> <span class="mf">10.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u00B0</span><span class="s2">&#39;&quot;</span>
            <span class="p">)</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="p">((</span><span class="n">dataX1</span><span class="p">,</span> <span class="n">dataY1</span><span class="p">,</span> <span class="n">dataZ1</span><span class="p">,</span> <span class="n">dataR1</span><span class="p">),</span> <span class="p">(</span><span class="n">dataX2</span><span class="p">,</span> <span class="n">dataY2</span><span class="p">,</span> <span class="n">dataZ2</span><span class="p">,</span> <span class="n">dataR2</span><span class="p">))</span></div>


<div class="viewcode-block" id="make3DPlot2"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.make3DPlot2">[docs]</a><span class="k">def</span> <span class="nf">make3DPlot2</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">npoints</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>

    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">npoints</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">npoints</span><span class="p">)</span>
    <span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>

    <span class="n">dataX1</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>
    <span class="n">dataY1</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>
    <span class="n">dataZ1</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>
    <span class="n">dataR1</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;0.0&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>

    <span class="n">dataX2</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>
    <span class="n">dataY2</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>
    <span class="n">dataZ2</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>
    <span class="n">dataR2</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;0.0&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>

    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">r</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">cu</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">cv</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)):</span>

            <span class="n">r</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="n">cv</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">])</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">cv</span><span class="p">])</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">cv</span><span class="p">])</span>

            <span class="n">r1_tmp</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">z1</span> <span class="o">=</span> <span class="n">r1_tmp</span> <span class="o">*</span> <span class="n">z</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">r1_tmp</span> <span class="o">*</span> <span class="n">x</span>
            <span class="n">y1</span> <span class="o">=</span> <span class="n">r1_tmp</span> <span class="o">*</span> <span class="n">y</span>
            <span class="n">dataX1</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="n">x1</span>
            <span class="n">dataY1</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="n">y1</span>
            <span class="n">dataZ1</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="n">z1</span>
            <span class="n">dataR1</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;&#39;&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;G&#39;&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;+&#39;min&#39;.sub()+&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;&#39; = &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">r1_tmp</span><span class="p">))</span> <span class="o">/</span> <span class="mf">10.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;GPa, &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u03B8</span><span class="s2"> = &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">]</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">/</span> <span class="mf">10.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u00B0</span><span class="s2">, &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u03c6</span><span class="s2"> = &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="n">cv</span><span class="p">]</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">/</span> <span class="mf">10.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u00B0</span><span class="s2">&#39;&quot;</span>
            <span class="p">)</span>

            <span class="n">r2_tmp</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">z2</span> <span class="o">=</span> <span class="n">r2_tmp</span> <span class="o">*</span> <span class="n">z</span>
            <span class="n">x2</span> <span class="o">=</span> <span class="n">r2_tmp</span> <span class="o">*</span> <span class="n">x</span>
            <span class="n">y2</span> <span class="o">=</span> <span class="n">r2_tmp</span> <span class="o">*</span> <span class="n">y</span>
            <span class="n">dataX2</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="n">x2</span>
            <span class="n">dataY2</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="n">y2</span>
            <span class="n">dataZ2</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="n">z2</span>
            <span class="n">dataR2</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;&#39;&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;G&#39;&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;+&#39;max&#39;.sub()+&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;&#39; = &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">r1_tmp</span><span class="p">))</span> <span class="o">/</span> <span class="mf">10.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;GPa, &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u03B8</span><span class="s2"> = &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">]</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">/</span> <span class="mf">10.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u00B0</span><span class="s2">, &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u03c6</span><span class="s2"> = &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="n">cv</span><span class="p">]</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">/</span> <span class="mf">10.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u00B0</span><span class="s2">&#39;&quot;</span>
            <span class="p">)</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="n">i</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100000</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">dataX1</span><span class="p">,</span> <span class="n">dataY1</span><span class="p">,</span> <span class="n">dataZ1</span><span class="p">,</span> <span class="n">dataR1</span><span class="p">),</span> <span class="p">(</span><span class="n">dataX2</span><span class="p">,</span> <span class="n">dataY2</span><span class="p">,</span> <span class="n">dataZ2</span><span class="p">,</span> <span class="n">dataR2</span><span class="p">))</span></div>


<div class="viewcode-block" id="make3DPlot3"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.make3DPlot3">[docs]</a><span class="k">def</span> <span class="nf">make3DPlot3</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">npoints</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>

    <span class="n">str1</span> <span class="o">=</span> <span class="n">legend</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">str2</span> <span class="o">=</span> <span class="n">legend</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">npoints</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">npoints</span><span class="p">)</span>
    <span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>

    <span class="n">dataX1</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>
    <span class="n">dataY1</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>
    <span class="n">dataZ1</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>
    <span class="n">dataR1</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;0.0&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>

    <span class="n">dataX2</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>
    <span class="n">dataY2</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>
    <span class="n">dataZ2</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>
    <span class="n">dataR2</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;0.0&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>

    <span class="n">dataX3</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>
    <span class="n">dataY3</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>
    <span class="n">dataZ3</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>
    <span class="n">dataR3</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;0.0&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span>

    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">r</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">]</span>
    <span class="n">ruv</span> <span class="o">=</span> <span class="p">[[</span><span class="n">r</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">))]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))]</span>
    <span class="k">for</span> <span class="n">cu</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">cv</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)):</span>
            <span class="n">ruv</span><span class="p">[</span><span class="n">cv</span><span class="p">][</span><span class="n">cu</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="n">cv</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">cu</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">cv</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)):</span>

            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">])</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">cv</span><span class="p">])</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">cv</span><span class="p">])</span>

            <span class="n">r</span> <span class="o">=</span> <span class="n">ruv</span><span class="p">[</span><span class="n">cv</span><span class="p">][</span><span class="n">cu</span><span class="p">]</span>
            <span class="n">r1_tmp</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">dataX1</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="n">r1_tmp</span> <span class="o">*</span> <span class="n">x</span>
            <span class="n">dataY1</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="n">r1_tmp</span> <span class="o">*</span> <span class="n">y</span>
            <span class="n">dataZ1</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="n">r1_tmp</span> <span class="o">*</span> <span class="n">z</span>
            <span class="n">dataR1</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;&#39;&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u03BD</span><span class="s2">&#39;&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;+&#39;min&#39;.sub()+&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;&#39; = &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">r1_tmp</span><span class="p">))</span> <span class="o">/</span> <span class="mf">100.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;, &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u03B8</span><span class="s2"> = &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">]</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">/</span> <span class="mf">100.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u00B0</span><span class="s2">, &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u03c6</span><span class="s2"> = &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="n">cv</span><span class="p">]</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">/</span> <span class="mf">100.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u00B0</span><span class="s2">&#39;&quot;</span>
            <span class="p">)</span>

            <span class="n">r2_tmp</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">dataX2</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="n">r2_tmp</span> <span class="o">*</span> <span class="n">x</span>
            <span class="n">dataY2</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="n">r2_tmp</span> <span class="o">*</span> <span class="n">y</span>
            <span class="n">dataZ2</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="n">r2_tmp</span> <span class="o">*</span> <span class="n">z</span>
            <span class="n">dataR2</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">r2_tmp</span><span class="p">))</span> <span class="o">/</span> <span class="mf">100.0</span>

            <span class="n">r3_tmp</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">dataX3</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="n">r3_tmp</span> <span class="o">*</span> <span class="n">x</span>
            <span class="n">dataY3</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="n">r3_tmp</span> <span class="o">*</span> <span class="n">y</span>
            <span class="n">dataZ3</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="n">r3_tmp</span> <span class="o">*</span> <span class="n">z</span>
            <span class="n">dataR3</span><span class="p">[</span><span class="n">cu</span><span class="p">][</span><span class="n">cv</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;&#39;&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u03BD</span><span class="s2">&#39;&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;+&#39;max&#39;.sub()+&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;&#39; = &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">r3_tmp</span><span class="p">))</span> <span class="o">/</span> <span class="mf">100.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;, &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u03B8</span><span class="s2"> = &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="n">cu</span><span class="p">]</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">/</span> <span class="mf">100.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u00B0</span><span class="s2">, &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u03c6</span><span class="s2"> = &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="n">cv</span><span class="p">]</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">/</span> <span class="mf">100.0</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\u00B0</span><span class="s2">&#39;&quot;</span>
            <span class="p">)</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">dataX1</span><span class="p">,</span> <span class="n">dataY1</span><span class="p">,</span> <span class="n">dataZ1</span><span class="p">,</span> <span class="n">dataR1</span><span class="p">),</span>
        <span class="p">(</span><span class="n">dataX2</span><span class="p">,</span> <span class="n">dataY2</span><span class="p">,</span> <span class="n">dataZ2</span><span class="p">,</span> <span class="n">dataR2</span><span class="p">),</span>
        <span class="p">(</span><span class="n">dataX3</span><span class="p">,</span> <span class="n">dataY3</span><span class="p">,</span> <span class="n">dataZ3</span><span class="p">,</span> <span class="n">dataR3</span><span class="p">),</span>
    <span class="p">)</span></div>


<span class="c1"># Polar plot functions</span>
<span class="c1">################################################################################################</span>


<div class="viewcode-block" id="makePolarPlot"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.makePolarPlot">[docs]</a><span class="k">def</span> <span class="nf">makePolarPlot</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="s2">&quot;xy&quot;</span><span class="p">,</span> <span class="n">npoints</span><span class="o">=</span><span class="mi">90</span><span class="p">):</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">npoints</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">u</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">p</span> <span class="o">==</span> <span class="s2">&quot;xy&quot;</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></div>


<div class="viewcode-block" id="makePolarPlotPosNeg"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.makePolarPlotPosNeg">[docs]</a><span class="k">def</span> <span class="nf">makePolarPlotPosNeg</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="s2">&quot;xy&quot;</span><span class="p">,</span> <span class="n">npoints</span><span class="o">=</span><span class="mi">90</span><span class="p">):</span>

    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">npoints</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">u</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">p</span> <span class="o">==</span> <span class="s2">&quot;xy&quot;</span><span class="p">:</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">u</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">p</span> <span class="o">==</span> <span class="s2">&quot;xy&quot;</span><span class="p">:</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
        <span class="n">y2</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">y2</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">))</span></div>


<div class="viewcode-block" id="makePolarPlot2"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.makePolarPlot2">[docs]</a><span class="k">def</span> <span class="nf">makePolarPlot2</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="s2">&quot;xy&quot;</span><span class="p">,</span> <span class="n">npoints</span><span class="o">=</span><span class="mi">61</span><span class="p">):</span>

    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">npoints</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">u</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">p</span> <span class="o">==</span> <span class="s2">&quot;xy&quot;</span><span class="p">:</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">iu</span><span class="p">)</span> <span class="k">for</span> <span class="n">ir</span><span class="p">,</span> <span class="n">iu</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">)])</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">iu</span><span class="p">)</span> <span class="k">for</span> <span class="n">ir</span><span class="p">,</span> <span class="n">iu</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">)])</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">iu</span><span class="p">)</span> <span class="k">for</span> <span class="n">ir</span><span class="p">,</span> <span class="n">iu</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">)])</span>
        <span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">iu</span><span class="p">)</span> <span class="k">for</span> <span class="n">ir</span><span class="p">,</span> <span class="n">iu</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">)])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">iu</span><span class="p">)</span> <span class="k">for</span> <span class="n">ir</span><span class="p">,</span> <span class="n">iu</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">)])</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">iu</span><span class="p">)</span> <span class="k">for</span> <span class="n">ir</span><span class="p">,</span> <span class="n">iu</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">)])</span>
        <span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">iu</span><span class="p">)</span> <span class="k">for</span> <span class="n">ir</span><span class="p">,</span> <span class="n">iu</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">)])</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">iu</span><span class="p">)</span> <span class="k">for</span> <span class="n">ir</span><span class="p">,</span> <span class="n">iu</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">)])</span>

    <span class="k">return</span> <span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">))</span></div>


<div class="viewcode-block" id="makePolarPlot3"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.makePolarPlot3">[docs]</a><span class="k">def</span> <span class="nf">makePolarPlot3</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="s2">&quot;xy&quot;</span><span class="p">,</span> <span class="n">npoints</span><span class="o">=</span><span class="mi">61</span><span class="p">):</span>

    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">npoints</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">u</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">p</span> <span class="o">==</span> <span class="s2">&quot;xy&quot;</span><span class="p">:</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">iu</span><span class="p">)</span> <span class="k">for</span> <span class="n">ir</span><span class="p">,</span> <span class="n">iu</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">)])</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">iu</span><span class="p">)</span> <span class="k">for</span> <span class="n">ir</span><span class="p">,</span> <span class="n">iu</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">)])</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">iu</span><span class="p">)</span> <span class="k">for</span> <span class="n">ir</span><span class="p">,</span> <span class="n">iu</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">)])</span>
        <span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">iu</span><span class="p">)</span> <span class="k">for</span> <span class="n">ir</span><span class="p">,</span> <span class="n">iu</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">)])</span>
        <span class="n">x3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ir</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">iu</span><span class="p">)</span> <span class="k">for</span> <span class="n">ir</span><span class="p">,</span> <span class="n">iu</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">)])</span>
        <span class="n">y3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ir</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">iu</span><span class="p">)</span> <span class="k">for</span> <span class="n">ir</span><span class="p">,</span> <span class="n">iu</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">)])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">iu</span><span class="p">)</span> <span class="k">for</span> <span class="n">ir</span><span class="p">,</span> <span class="n">iu</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">)])</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">iu</span><span class="p">)</span> <span class="k">for</span> <span class="n">ir</span><span class="p">,</span> <span class="n">iu</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">)])</span>
        <span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">iu</span><span class="p">)</span> <span class="k">for</span> <span class="n">ir</span><span class="p">,</span> <span class="n">iu</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">)])</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">iu</span><span class="p">)</span> <span class="k">for</span> <span class="n">ir</span><span class="p">,</span> <span class="n">iu</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">)])</span>
        <span class="n">y3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ir</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">iu</span><span class="p">)</span> <span class="k">for</span> <span class="n">ir</span><span class="p">,</span> <span class="n">iu</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">)])</span>
        <span class="n">x3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ir</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">iu</span><span class="p">)</span> <span class="k">for</span> <span class="n">ir</span><span class="p">,</span> <span class="n">iu</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">)])</span>

    <span class="k">return</span> <span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span> <span class="p">(</span><span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">))</span></div>


<span class="c1">########################################################################################################</span>


<div class="viewcode-block" id="dirVec"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.dirVec">[docs]</a><span class="k">def</span> <span class="nf">dirVec</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span>
        <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span>
        <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span>
    <span class="p">]</span></div>


<div class="viewcode-block" id="dirVec1"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.dirVec1">[docs]</a><span class="k">def</span> <span class="nf">dirVec1</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">chi</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span>
        <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span>
        <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span>
    <span class="p">]</span></div>


<div class="viewcode-block" id="dirVec2"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.dirVec2">[docs]</a><span class="k">def</span> <span class="nf">dirVec2</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">chi</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">chi</span><span class="p">)</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">chi</span><span class="p">),</span>
        <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">chi</span><span class="p">)</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">chi</span><span class="p">),</span>
        <span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">chi</span><span class="p">),</span>
    <span class="p">]</span></div>


<span class="c1"># Functions to minimize/maximize</span>
<div class="viewcode-block" id="minimize"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.minimize">[docs]</a><span class="k">def</span> <span class="nf">minimize</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">dim</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">25</span>
    <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="c1"># TODO -- try basin hopping or annealing</span>
    <span class="k">return</span> <span class="n">optimize</span><span class="o">.</span><span class="n">brute</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">Ns</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">finish</span><span class="o">=</span><span class="n">optimize</span><span class="o">.</span><span class="n">fmin</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span></div>


<div class="viewcode-block" id="maximize"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.maximize">[docs]</a><span class="k">def</span> <span class="nf">maximize</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">dim</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">dim</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span></div>


<div class="viewcode-block" id="ELATE"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.ELATE">[docs]</a><span class="k">class</span> <span class="nc">ELATE</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">elas</span> <span class="o">=</span> <span class="n">Elastic</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elasList</span> <span class="o">=</span> <span class="n">s</span>

        <span class="n">minE</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">Young</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">maxE</span> <span class="o">=</span> <span class="n">maximize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">Young</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">minLC</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">LC</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">maxLC</span> <span class="o">=</span> <span class="n">maximize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">LC</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">minG</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">shear</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">maxG</span> <span class="o">=</span> <span class="n">maximize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">shear</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">minNu</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">Poisson</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">maxNu</span> <span class="o">=</span> <span class="n">maximize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">Poisson</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">voigtE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">averages</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reussE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">averages</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hillE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">averages</span><span class="p">()[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_E</span> <span class="o">=</span> <span class="n">maxE</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_E</span> <span class="o">=</span> <span class="n">minE</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_axis_E</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">dirVec</span><span class="p">(</span><span class="o">*</span><span class="n">minE</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_axis_E</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">dirVec</span><span class="p">(</span><span class="o">*</span><span class="n">maxE</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">anis_E</span> <span class="o">=</span> <span class="n">maxE</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">minE</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">voigtLC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">averages</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reussLC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">averages</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hillLC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">averages</span><span class="p">()[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_LC</span> <span class="o">=</span> <span class="n">maxLC</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_LC</span> <span class="o">=</span> <span class="n">minLC</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_axis_LC</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">dirVec</span><span class="p">(</span><span class="o">*</span><span class="n">minLC</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_axis_LC</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">dirVec</span><span class="p">(</span><span class="o">*</span><span class="n">maxLC</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">minLC</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">anis_LC</span> <span class="o">=</span> <span class="n">maxLC</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">minLC</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">anis_LC</span> <span class="o">=</span> <span class="s2">&quot;&amp;infin;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">voigtShear</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">averages</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reussShear</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">averages</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hillShear</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">averages</span><span class="p">()[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_Shear</span> <span class="o">=</span> <span class="n">maxG</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_Shear</span> <span class="o">=</span> <span class="n">minG</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_axis_Shear</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">dirVec1</span><span class="p">(</span><span class="o">*</span><span class="n">minG</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_axis_Shear</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">dirVec1</span><span class="p">(</span><span class="o">*</span><span class="n">maxG</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mix_2nd_axis_Shear</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">dirVec2</span><span class="p">(</span><span class="o">*</span><span class="n">minG</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_2nd_axis_Shear</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">dirVec2</span><span class="p">(</span><span class="o">*</span><span class="n">maxG</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">anis_Shear</span> <span class="o">=</span> <span class="n">maxG</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">minG</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">voigtPoisson</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">averages</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reussPoisson</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">averages</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hillPoisson</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">averages</span><span class="p">()[</span><span class="mi">2</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_Poisson</span> <span class="o">=</span> <span class="n">maxNu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_Poisson</span> <span class="o">=</span> <span class="n">minNu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_axis_Poisson</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">dirVec1</span><span class="p">(</span><span class="o">*</span><span class="n">minNu</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_axis_Poisson</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">dirVec1</span><span class="p">(</span><span class="o">*</span><span class="n">maxNu</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_2nd_axis_Poisson</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">dirVec2</span><span class="p">(</span><span class="o">*</span><span class="n">minNu</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_2nd_axis_Poisson</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">dirVec2</span><span class="p">(</span><span class="o">*</span><span class="n">maxNu</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">minNu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">maxNu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">anis_Poisson</span> <span class="o">=</span> <span class="n">maxNu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">minNu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">anix_Poisson</span> <span class="o">=</span> <span class="s2">&quot;&amp;infin;&quot;</span>

<div class="viewcode-block" id="ELATE.YOUNG2D"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.ELATE.YOUNG2D">[docs]</a>    <span class="k">def</span> <span class="nf">YOUNG2D</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">data1</span> <span class="o">=</span> <span class="n">makePolarPlot</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">Young</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">]),</span>
            <span class="s2">&quot;Young&#39;s modulus in (xy) plane&quot;</span><span class="p">,</span>
            <span class="s2">&quot;xy&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">data2</span> <span class="o">=</span> <span class="n">makePolarPlot</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">Young</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;Young&#39;s modulus in (xz) plane&quot;</span><span class="p">,</span> <span class="s2">&quot;xz&quot;</span>
        <span class="p">)</span>
        <span class="n">data3</span> <span class="o">=</span> <span class="n">makePolarPlot</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">Young</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]),</span>
            <span class="s2">&quot;Young&#39;s modulus in (yz) plane&quot;</span><span class="p">,</span>
            <span class="s2">&quot;yz&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">data3</span><span class="p">)</span></div>

<div class="viewcode-block" id="ELATE.YOUNG3D"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.ELATE.YOUNG3D">[docs]</a>    <span class="k">def</span> <span class="nf">YOUNG3D</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">isOrthorhombic</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">elas</span> <span class="o">=</span> <span class="n">ElasticOrtho</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">make3DPlot</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">Young_2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="s2">&quot;Young&#39;s modulus&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span></div>

<div class="viewcode-block" id="ELATE.LC2D"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.ELATE.LC2D">[docs]</a>    <span class="k">def</span> <span class="nf">LC2D</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">data1</span> <span class="o">=</span> <span class="n">makePolarPlotPosNeg</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">LC</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">]),</span>
            <span class="s2">&quot;linear compressibility in (xy) plane&quot;</span><span class="p">,</span>
            <span class="s2">&quot;xy&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">data2</span> <span class="o">=</span> <span class="n">makePolarPlotPosNeg</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">LC</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;linear compressibility in (xz) plane&quot;</span><span class="p">,</span> <span class="s2">&quot;xz&quot;</span>
        <span class="p">)</span>
        <span class="n">data3</span> <span class="o">=</span> <span class="n">makePolarPlotPosNeg</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">LC</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]),</span>
            <span class="s2">&quot;linear compressibility in (yz) plane&quot;</span><span class="p">,</span>
            <span class="s2">&quot;yz&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">data3</span><span class="p">)</span></div>

<div class="viewcode-block" id="ELATE.LC3D"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.ELATE.LC3D">[docs]</a>    <span class="k">def</span> <span class="nf">LC3D</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">isOrthorhombic</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">elas</span> <span class="o">=</span> <span class="n">ElasticOrtho</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">make3DPlotPosNeg</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">LC_2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="s2">&quot;Linear compressiblity&quot;</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span></div>

<div class="viewcode-block" id="ELATE.SHEAR2D"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.ELATE.SHEAR2D">[docs]</a>    <span class="k">def</span> <span class="nf">SHEAR2D</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">data1</span> <span class="o">=</span> <span class="n">makePolarPlot2</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">shear2D</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">]),</span>
            <span class="s2">&quot;Shear modulus in (xy) plane&quot;</span><span class="p">,</span>
            <span class="s2">&quot;xy&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">data2</span> <span class="o">=</span> <span class="n">makePolarPlot2</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">shear2D</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;Shear modulus in (xz) plane&quot;</span><span class="p">,</span> <span class="s2">&quot;xz&quot;</span>
        <span class="p">)</span>
        <span class="n">data3</span> <span class="o">=</span> <span class="n">makePolarPlot2</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">shear2D</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]),</span>
            <span class="s2">&quot;Shear modulus in (yz) plane&quot;</span><span class="p">,</span>
            <span class="s2">&quot;yz&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">data3</span><span class="p">)</span></div>

<div class="viewcode-block" id="ELATE.SHEAR3D"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.ELATE.SHEAR3D">[docs]</a>    <span class="k">def</span> <span class="nf">SHEAR3D</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">isOrthorhombic</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">elas</span> <span class="o">=</span> <span class="n">ElasticOrtho</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">make3DPlot2</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">shear3D</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span><span class="p">),</span> <span class="s2">&quot;Shear modulus&quot;</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span></div>

<div class="viewcode-block" id="ELATE.POISSON2D"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.ELATE.POISSON2D">[docs]</a>    <span class="k">def</span> <span class="nf">POISSON2D</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">data1</span> <span class="o">=</span> <span class="n">makePolarPlot3</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">Poisson2D</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">]),</span>
            <span class="s2">&quot;Poisson&#39;s ratio in (xy) plane&quot;</span><span class="p">,</span>
            <span class="s2">&quot;xy&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">data2</span> <span class="o">=</span> <span class="n">makePolarPlot3</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">Poisson2D</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;Poisson&#39;s ratio in (xz) plane&quot;</span><span class="p">,</span> <span class="s2">&quot;xz&quot;</span>
        <span class="p">)</span>
        <span class="n">data3</span> <span class="o">=</span> <span class="n">makePolarPlot3</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">Poisson2D</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]),</span>
            <span class="s2">&quot;Poisson&#39;s ratio in (yz) plane&quot;</span><span class="p">,</span>
            <span class="s2">&quot;yz&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">data3</span><span class="p">)</span></div>

<div class="viewcode-block" id="ELATE.POISSON3D"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.ELATE.POISSON3D">[docs]</a>    <span class="k">def</span> <span class="nf">POISSON3D</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">isOrthorhombic</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">elas</span> <span class="o">=</span> <span class="n">ElasticOrtho</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">make3DPlot3</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">poisson3D</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span><span class="p">),</span> <span class="s2">&quot;Poisson&#39;s ratio&quot;</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span></div>

    <span class="c1">##############################################################################</span>
    <span class="c1"># Plotting functions</span>
    <span class="c1">#############################################################################</span>
<div class="viewcode-block" id="ELATE.plot_3D"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.ELATE.plot_3D">[docs]</a>    <span class="k">def</span> <span class="nf">plot_3D</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elastic_calc</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">pyvista</span> <span class="k">as</span> <span class="nn">pv</span>
        <span class="kn">from</span> <span class="nn">pyvistaqt</span> <span class="kn">import</span> <span class="n">BackgroundPlotter</span>

        <span class="n">plotter</span> <span class="o">=</span> <span class="n">BackgroundPlotter</span><span class="p">()</span>

        <span class="n">x</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">y</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">z</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">r</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">elastic_calc</span> <span class="o">==</span> <span class="s2">&quot;POISSON&quot;</span><span class="p">:</span>
            <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">POISSON3D</span><span class="p">()</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">icolor</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">func</span><span class="p">)),</span> <span class="n">colors</span><span class="p">):</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">func</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">func</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">func</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">func</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">func</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)):</span>
                    <span class="k">continue</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">grid</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">StructuredGrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">ix</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">plotter</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">icolor</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">plotter</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">icolor</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">elastic_calc</span> <span class="o">==</span> <span class="s2">&quot;SHEAR&quot;</span><span class="p">:</span>
            <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SHEAR3D</span><span class="p">()</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">icolor</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">func</span><span class="p">)),</span> <span class="n">colors</span><span class="p">):</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">func</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">func</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">func</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">func</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">func</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)):</span>
                    <span class="k">continue</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">grid</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">StructuredGrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">ix</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">plotter</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">icolor</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">plotter</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">icolor</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">elastic_calc</span> <span class="o">==</span> <span class="s2">&quot;LC&quot;</span><span class="p">:</span>
            <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LC3D</span><span class="p">()</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">icolor</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">func</span><span class="p">)),</span> <span class="n">colors</span><span class="p">):</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">func</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">func</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">func</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">func</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">func</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)):</span>
                    <span class="k">continue</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">grid</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">StructuredGrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">ix</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">plotter</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">icolor</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">plotter</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">icolor</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">elastic_calc</span> <span class="o">==</span> <span class="s2">&quot;YOUNG&quot;</span><span class="p">:</span>
            <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">YOUNG3D</span><span class="p">()</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;green&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">icolor</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">func</span><span class="p">)),</span> <span class="n">colors</span><span class="p">):</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">func</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">func</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">func</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">func</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">func</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)):</span>
                    <span class="k">continue</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">grid</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">StructuredGrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">ix</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">plotter</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">icolor</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">plotter</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">icolor</span><span class="p">)</span>

        <span class="n">plotter</span><span class="o">.</span><span class="n">add_axes</span><span class="p">()</span>
        <span class="n">plotter</span><span class="o">.</span><span class="n">show_grid</span><span class="p">()</span></div>

<div class="viewcode-block" id="ELATE.plot_2D"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.ELATE.plot_2D">[docs]</a>    <span class="k">def</span> <span class="nf">plot_2D</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elastic_calc</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">subTitles</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;XY&quot;</span><span class="p">,</span> <span class="s2">&quot;XZ&quot;</span><span class="p">,</span> <span class="s2">&quot;YZ&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">elastic_calc</span> <span class="o">==</span> <span class="s2">&quot;POISSON&quot;</span><span class="p">:</span>
            <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">POISSON2D</span><span class="p">()</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">]</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Poisson - Neg&quot;</span><span class="p">,</span> <span class="s2">&quot;Poisson - Pos&quot;</span><span class="p">,</span> <span class="s2">&quot;Poisson - Max&quot;</span><span class="p">]</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Poisson&#39;s ratio&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">iplane</span><span class="p">,</span> <span class="n">title</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">func</span><span class="p">)),</span> <span class="n">subTitles</span><span class="p">):</span>

                <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">iplane</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">iplot</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">func</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">colors</span><span class="p">):</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                        <span class="n">func</span><span class="p">[</span><span class="n">iplane</span><span class="p">][</span><span class="n">iplot</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">func</span><span class="p">[</span><span class="n">iplane</span><span class="p">][</span><span class="n">iplot</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span>
                    <span class="p">)</span>

        <span class="k">elif</span> <span class="n">elastic_calc</span> <span class="o">==</span> <span class="s2">&quot;SHEAR&quot;</span><span class="p">:</span>
            <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SHEAR2D</span><span class="p">()</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">]</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Shear - Max&quot;</span><span class="p">,</span> <span class="s2">&quot;Shear -&quot;</span><span class="p">]</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Shear modulus&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">iplane</span><span class="p">,</span> <span class="n">title</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">func</span><span class="p">)),</span> <span class="n">subTitles</span><span class="p">):</span>

                <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">iplane</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">iplot</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">func</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">colors</span><span class="p">):</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                        <span class="n">func</span><span class="p">[</span><span class="n">iplane</span><span class="p">][</span><span class="n">iplot</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">func</span><span class="p">[</span><span class="n">iplane</span><span class="p">][</span><span class="n">iplot</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span>
                    <span class="p">)</span>

        <span class="k">elif</span> <span class="n">elastic_calc</span> <span class="o">==</span> <span class="s2">&quot;LC&quot;</span><span class="p">:</span>
            <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LC2D</span><span class="p">()</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">]</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;LC-positive&quot;</span><span class="p">,</span> <span class="s2">&quot;LC-negative&quot;</span><span class="p">]</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Linear Compression&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">iplane</span><span class="p">,</span> <span class="n">title</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">func</span><span class="p">)),</span> <span class="n">subTitles</span><span class="p">):</span>

                <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">iplane</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">iplot</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">func</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">colors</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                        <span class="n">func</span><span class="p">[</span><span class="n">iplane</span><span class="p">][</span><span class="n">iplot</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">func</span><span class="p">[</span><span class="n">iplane</span><span class="p">][</span><span class="n">iplot</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                        <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                        <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
                    <span class="p">)</span>

        <span class="k">elif</span> <span class="n">elastic_calc</span> <span class="o">==</span> <span class="s2">&quot;YOUNG&quot;</span><span class="p">:</span>
            <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">YOUNG2D</span><span class="p">()</span>
            <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;YOUNG&quot;</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Young&#39;s Modulus&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">iplane</span><span class="p">,</span> <span class="n">title</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">func</span><span class="p">)),</span> <span class="n">subTitles</span><span class="p">):</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">iplane</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">func</span><span class="p">[</span><span class="n">iplane</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">func</span><span class="p">[</span><span class="n">iplane</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span></div>

<div class="viewcode-block" id="ELATE.print_properties"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.ELATE.print_properties">[docs]</a>    <span class="k">def</span> <span class="nf">print_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">#        print(&quot;\n \n Input: compliance matrix(coefficients in GPa) of\n&quot;)</span>
        <span class="c1">#        for x in self.elasList:</span>
        <span class="c1">#            print(str(x))</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Average properties&quot;</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> </span><span class="se">\n</span><span class="s2">                         Voigt     Reuss    Hill&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-------------------------------------------------------&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;Bulk modulus   (GPa)  </span><span class="si">%9.3f</span><span class="s2"> </span><span class="si">%9.3f</span><span class="s2"> </span><span class="si">%9.3f</span><span class="s2"> &quot;</span>
            <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">averages</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">averages</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">averages</span><span class="p">()[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;Shear modulus  (GPa)  </span><span class="si">%9.3f</span><span class="s2"> </span><span class="si">%9.3f</span><span class="s2"> </span><span class="si">%9.3f</span><span class="s2"> &quot;</span>
            <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">averages</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">averages</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">averages</span><span class="p">()[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;Young modulus  (GPa)  </span><span class="si">%9.3f</span><span class="s2"> </span><span class="si">%9.3f</span><span class="s2"> </span><span class="si">%9.3f</span><span class="s2"> &quot;</span>
            <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">averages</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">averages</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">averages</span><span class="p">()[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;Poisson ratio         </span><span class="si">%9.3f</span><span class="s2"> </span><span class="si">%9.3f</span><span class="s2"> </span><span class="si">%9.3f</span><span class="s2"> &quot;</span>
            <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">averages</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">averages</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">averages</span><span class="p">()[</span><span class="mi">2</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-------------------------------------------------------&quot;</span><span class="p">)</span>
        <span class="c1"># printer.printMatix(elastic_rowsList)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Eigenvalues of compliance matrix&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> </span><span class="se">\n</span><span class="s2">   lamda_1  lamda_2  lamda_3  lamda_4  lamda_5  lamda_6&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---------------------------------------------------------------&quot;</span><span class="p">)</span>
        <span class="n">eigenval</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%9.3f</span><span class="s2"> </span><span class="si">%9.3f</span><span class="s2"> </span><span class="si">%9.3f</span><span class="s2"> </span><span class="si">%9.3f</span><span class="s2"> </span><span class="si">%9.3f</span><span class="s2"> </span><span class="si">%9.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">eigenval</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--------------------------------------------------------------&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">eigenval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s1">&#39;&lt;div class=&quot;error&quot;&gt;Stiffness matrix is not definite positive, crystal is mechanically unstable&lt;br/&gt;&#39;</span>
            <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variations of the elastic moduli&quot;</span><span class="p">)</span>
        <span class="c1">#        print(&quot;\n \n   Young&#39;s Modulus                Linear Compressibility                   Shear Modulus              Poisson&#39;s Ratio&quot;)</span>
        <span class="c1">#        print(&quot;    Emin         Emax             betaMin            betaMax               Gmin        Gmax           Nu_min      Nu_max&quot;)</span>
        <span class="c1">#        print(&quot;----------------------------------------------------------------------------------------------&quot;)</span>
        <span class="n">minE</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">Young</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">maxE</span> <span class="o">=</span> <span class="n">maximize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">Young</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">minLC</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">LC</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">maxLC</span> <span class="o">=</span> <span class="n">maximize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">LC</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">minG</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">shear</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">maxG</span> <span class="o">=</span> <span class="n">maximize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">shear</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">minNu</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">Poisson</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">maxNu</span> <span class="o">=</span> <span class="n">maximize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elas</span><span class="o">.</span><span class="n">Poisson</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="c1"># print(type((minE,maxE,minLC,maxLC,minG,maxG,minNu,maxNu)))</span>
        <span class="c1"># print(&quot;%9.3f GPa  %9.3f GPa  %9.3f TPa^-1   %9.3f TPa^-1    %9.3f GPa  %9.3f GPa  %9.3f  %9.3f&quot; % (minE[1],maxE[1],minLC[1],maxLC[1],minG[1],maxG[1],minNu[1],maxNu[1]))</span>

        <span class="n">anisE</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%8.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">maxE</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">minE</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">anisLC</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%8.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">maxLC</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">minLC</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="k">if</span> <span class="n">minLC</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&amp;infin;&quot;</span>
        <span class="n">anisG</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%8.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">maxG</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">minG</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">anisNu</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;</span><span class="si">%8.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">maxNu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">minNu</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="k">if</span> <span class="n">minNu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">maxNu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&amp;infin;&quot;</span>
        <span class="p">)</span>

        <span class="c1"># print(&quot;       %s                     %s                                %s                         %s&quot; % (anisE,anisLC,anisG,anisNu))</span>
        <span class="c1"># print(dirVec1(*minG[0]))</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> </span><span class="se">\n</span><span class="s2">                                  Min       Max   ||   Anisotropy&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;----------------------------------------------------------------------------------------&quot;</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;Young&#39;s Modulus     (GPa)      </span><span class="si">%9.3f</span><span class="s2"> </span><span class="si">%9.3f</span><span class="s2"> || </span><span class="si">%s</span><span class="s2"> &quot;</span>
            <span class="o">%</span> <span class="p">(</span><span class="n">minE</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">maxE</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">anisE</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;         Min Axis:    </span><span class="si">%s</span><span class="s2">      </span><span class="se">\n</span><span class="s2">         Max Axis:    </span><span class="si">%s</span><span class="s2"> &quot;</span>
            <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">dirVec</span><span class="p">(</span><span class="o">*</span><span class="n">minE</span><span class="p">[</span><span class="mi">0</span><span class="p">]))),</span> <span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">dirVec</span><span class="p">(</span><span class="o">*</span><span class="n">maxE</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;----------------------------------------------------------------------------------------&quot;</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;Linear Compression   (TPa^-1)  </span><span class="si">%9.3f</span><span class="s2"> </span><span class="si">%9.3f</span><span class="s2"> || </span><span class="si">%s</span><span class="s2"> &quot;</span>
            <span class="o">%</span> <span class="p">(</span><span class="n">minE</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">maxE</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">anisLC</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;         Min Axis:    </span><span class="si">%s</span><span class="s2">      </span><span class="se">\n</span><span class="s2">         Max Axis:    </span><span class="si">%s</span><span class="s2"> &quot;</span>
            <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">dirVec</span><span class="p">(</span><span class="o">*</span><span class="n">minLC</span><span class="p">[</span><span class="mi">0</span><span class="p">]))),</span> <span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">dirVec</span><span class="p">(</span><span class="o">*</span><span class="n">maxLC</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;----------------------------------------------------------------------------------------&quot;</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;Shear Modulus   (GPa)          </span><span class="si">%9.3f</span><span class="s2"> </span><span class="si">%9.3f</span><span class="s2"> || </span><span class="si">%s</span><span class="s2"> &quot;</span>
            <span class="o">%</span> <span class="p">(</span><span class="n">minE</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">maxE</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">anisG</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;         Min Axis:    </span><span class="si">%s</span><span class="s2">      </span><span class="se">\n</span><span class="s2">         Max Axis:    </span><span class="si">%s</span><span class="s2"> &quot;</span>
            <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">dirVec1</span><span class="p">(</span><span class="o">*</span><span class="n">minG</span><span class="p">[</span><span class="mi">0</span><span class="p">]))),</span> <span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">dirVec1</span><span class="p">(</span><span class="o">*</span><span class="n">maxG</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;         Second Min Axis:    </span><span class="si">%s</span><span class="s2">      </span><span class="se">\n</span><span class="s2">         Second Max Axis:    </span><span class="si">%s</span><span class="s2"> &quot;</span>
            <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">dirVec2</span><span class="p">(</span><span class="o">*</span><span class="n">minG</span><span class="p">[</span><span class="mi">0</span><span class="p">]))),</span> <span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">dirVec2</span><span class="p">(</span><span class="o">*</span><span class="n">maxG</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;----------------------------------------------------------------------------------------&quot;</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;Poisson Ratio                 </span><span class="si">%9.3f</span><span class="s2"> </span><span class="si">%9.3f</span><span class="s2"> || </span><span class="si">%s</span><span class="s2"> &quot;</span>
            <span class="o">%</span> <span class="p">(</span><span class="n">minE</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">maxE</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">anisNu</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;         Min Axis:    </span><span class="si">%s</span><span class="s2">      </span><span class="se">\n</span><span class="s2">         Max Axis:    </span><span class="si">%s</span><span class="s2"> &quot;</span>
            <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">dirVec1</span><span class="p">(</span><span class="o">*</span><span class="n">minNu</span><span class="p">[</span><span class="mi">0</span><span class="p">]))),</span> <span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">dirVec1</span><span class="p">(</span><span class="o">*</span><span class="n">maxNu</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;         Second Min Axis:    </span><span class="si">%s</span><span class="s2">      </span><span class="se">\n</span><span class="s2">         Second Max Axis:    </span><span class="si">%s</span><span class="s2"> &quot;</span>
            <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">dirVec2</span><span class="p">(</span><span class="o">*</span><span class="n">minNu</span><span class="p">[</span><span class="mi">0</span><span class="p">]))),</span> <span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">dirVec2</span><span class="p">(</span><span class="o">*</span><span class="n">maxNu</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>
        <span class="p">)</span></div></div>


<span class="c1">#        print(</span>
<span class="c1">#            &quot;Shear modulus  (GPa)  %9.3f %9.3f %9.3f &quot;</span>
<span class="c1">#            % (self.elas.averages()[0][1], self.elas.averages()[1][1], self.elas.averages()[2][1])</span>
<span class="c1">#        )</span>
<span class="c1">#        print(</span>
<span class="c1">#            &quot;Young modulus  (GPa)  %9.3f %9.3f %9.3f &quot;</span>
<span class="c1">#            % (self.elas.averages()[0][2], self.elas.averages()[1][2], self.elas.averages()[2][2])</span>
<span class="c1">#        )</span>
<span class="c1">#        print(</span>
<span class="c1">#            &quot;Poisson ratio         %9.3f %9.3f %9.3f &quot;</span>
<span class="c1">#            % (self.elas.averages()[0][3], self.elas.averages()[2][3], self.elas.averages()[2][3]))</span>
<span class="c1">#</span>
<span class="c1">#        print(&quot;-------------------------------------------------------&quot;)</span>
<span class="c1">#        print(&quot;%9.3f %9.3f %9.3f %9.3f %9.3f %9.3f %9.3f %9.3f&quot; % tuple(dirVec(*minE[0])) + tuple(dirVec(*maxE[0])) + tuple(dirVec(*minLC[0])) + tuple(dirVec(*maxLC[0])) + tuple(dirVec1(*minG[0])) +  tuple(dirVec1(*maxG[0])) + tuple(dirVec1(*minNu[0])) + tuple(dirVec1(*maxNu[0])))</span>
<span class="c1">#        print(&quot;%9.3f %9.3f %9.3f %9.3f %9.3f %9.3f %9.3f %9.3f&quot; % tuple(dirVec2(*minG[0])) + tuple(dirVec2(*maxG[0])) + tuple(dirVec2(*minNu[0])) + tuple(dirVec2(*maxNu[0])))</span>


<div class="viewcode-block" id="Elastic"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.Elastic">[docs]</a><span class="k">class</span> <span class="nc">Elastic</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;An elastic tensor, along with methods to access it&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the elastic tensor from a string&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;no matrix was provided&quot;</span><span class="p">)</span>

        <span class="c1"># Argument can be a 6-line string, a list of list, or a string representation of the list of list</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="c1"># Remove braces and pipes</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>

            <span class="c1"># Remove empty lines</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">6</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;should have six rows&quot;</span><span class="p">)</span>

            <span class="c1"># Convert to float</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">mat</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;not all entries are numbers&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="c1"># If we already have a list, simply use it</span>
            <span class="n">mat</span> <span class="o">=</span> <span class="n">s</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid argument as matrix&quot;</span><span class="p">)</span>

        <span class="c1"># Make it into a square matrix</span>
        <span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mat</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
            <span class="c1"># Is it upper triangular?</span>
            <span class="k">if</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">mat</span><span class="p">))</span> <span class="o">==</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
                <span class="n">mat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="n">mat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
                <span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>

            <span class="c1"># Is it lower triangular?</span>
            <span class="k">if</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">mat</span><span class="p">))</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]:</span>
                <span class="n">mat</span> <span class="o">=</span> <span class="p">[</span><span class="n">mat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">5</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
                <span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">mat</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;should be a square matrix&quot;</span><span class="p">)</span>

        <span class="c1"># Check that is is symmetric, or make it symmetric</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tril</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">mat</span> <span class="o">=</span> <span class="n">mat</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">mat</span> <span class="o">=</span> <span class="n">mat</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">tril</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">mat</span> <span class="o">-</span> <span class="n">mat</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mf">1e-3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;should be symmetric, or triangular&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">mat</span> <span class="o">-</span> <span class="n">mat</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">mat</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">mat</span> <span class="o">+</span> <span class="n">mat</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>

        <span class="c1"># Store it</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span> <span class="o">=</span> <span class="n">mat</span>

        <span class="c1"># Put it in a more useful representation</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SVoigt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;matrix is singular&quot;</span><span class="p">)</span>

        <span class="n">VoigtMat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>

        <span class="k">def</span> <span class="nf">SVoigtCoeff</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
            <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">p</span> <span class="o">//</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">q</span> <span class="o">//</span> <span class="mi">3</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span>
                <span class="p">[</span>
                    <span class="p">[</span>
                        <span class="n">SVoigtCoeff</span><span class="p">(</span><span class="n">VoigtMat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">VoigtMat</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">l</span><span class="p">])</span>
                        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">SVoigt</span><span class="p">[</span><span class="n">VoigtMat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]][</span><span class="n">VoigtMat</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">l</span><span class="p">]]</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                    <span class="p">]</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                <span class="p">]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="k">return</span>

<div class="viewcode-block" id="Elastic.isOrthorhombic"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.Elastic.isOrthorhombic">[docs]</a>    <span class="k">def</span> <span class="nf">isOrthorhombic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">iszero</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.0e-3</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elastic.isCubic"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.Elastic.isCubic">[docs]</a>    <span class="k">def</span> <span class="nf">isCubic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">iszero</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.0e-3</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
            <span class="ow">and</span> <span class="n">iszero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Elastic.Young"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.Elastic.Young">[docs]</a>    <span class="k">def</span> <span class="nf">Young</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">dirVec</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">r</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">][</span><span class="n">l</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">r</span></div>

<div class="viewcode-block" id="Elastic.Young_2"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.Elastic.Young_2">[docs]</a>    <span class="k">def</span> <span class="nf">Young_2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">dirVec</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">][</span><span class="n">l</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">r</span></div>

<div class="viewcode-block" id="Elastic.LC"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.Elastic.LC">[docs]</a>    <span class="k">def</span> <span class="nf">LC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">dirVec</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">r</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">r</span></div>

<div class="viewcode-block" id="Elastic.LC_2"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.Elastic.LC_2">[docs]</a>    <span class="k">def</span> <span class="nf">LC_2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">dirVec</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">r</span></div>

<div class="viewcode-block" id="Elastic.shear"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.Elastic.shear">[docs]</a>    <span class="k">def</span> <span class="nf">shear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">dirVec</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">dirVec2</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">r</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">][</span><span class="n">l</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span></div>

<div class="viewcode-block" id="Elastic.Poisson"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.Elastic.Poisson">[docs]</a>    <span class="k">def</span> <span class="nf">Poisson</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">dirVec</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">dirVec2</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">r1</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">][</span><span class="n">l</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">][</span><span class="n">l</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">r1</span> <span class="o">/</span> <span class="n">r2</span></div>

<div class="viewcode-block" id="Elastic.averages"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.Elastic.averages">[docs]</a>    <span class="k">def</span> <span class="nf">averages</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="mi">3</span>
        <span class="n">B</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">3</span>
        <span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span> <span class="o">/</span> <span class="mi">3</span>
        <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SVoigt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">SVoigt</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">SVoigt</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="mi">3</span>
        <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SVoigt</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">SVoigt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">SVoigt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">3</span>
        <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SVoigt</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">SVoigt</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">SVoigt</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span> <span class="o">/</span> <span class="mi">3</span>

        <span class="n">KV</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">B</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span>
        <span class="n">GV</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="n">B</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">C</span><span class="p">)</span> <span class="o">/</span> <span class="mi">5</span>

        <span class="n">KR</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">GR</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">a</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span>

        <span class="n">KH</span> <span class="o">=</span> <span class="p">(</span><span class="n">KV</span> <span class="o">+</span> <span class="n">KR</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">GH</span> <span class="o">=</span> <span class="p">(</span><span class="n">GV</span> <span class="o">+</span> <span class="n">GR</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="k">return</span> <span class="p">[</span>
            <span class="p">[</span>
                <span class="n">KV</span><span class="p">,</span>
                <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">GV</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">9</span> <span class="o">*</span> <span class="n">KV</span><span class="p">)),</span>
                <span class="n">GV</span><span class="p">,</span>
                <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">GV</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">KV</span> <span class="o">+</span> <span class="n">GV</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="p">[</span>
                <span class="n">KR</span><span class="p">,</span>
                <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">GR</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">9</span> <span class="o">*</span> <span class="n">KR</span><span class="p">)),</span>
                <span class="n">GR</span><span class="p">,</span>
                <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">GR</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">KR</span> <span class="o">+</span> <span class="n">GR</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="p">[</span>
                <span class="n">KH</span><span class="p">,</span>
                <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">GH</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">9</span> <span class="o">*</span> <span class="n">KH</span><span class="p">)),</span>
                <span class="n">GH</span><span class="p">,</span>
                <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">GH</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">KH</span> <span class="o">+</span> <span class="n">GH</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">]</span></div>

<div class="viewcode-block" id="Elastic.shear2D"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.Elastic.shear2D">[docs]</a>    <span class="k">def</span> <span class="nf">shear2D</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">ftol</span> <span class="o">=</span> <span class="mf">0.001</span>
        <span class="n">xtol</span> <span class="o">=</span> <span class="mf">0.01</span>

        <span class="k">def</span> <span class="nf">func1</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">z</span><span class="p">])</span>

        <span class="n">r1</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span>
            <span class="n">func1</span><span class="p">,</span>
            <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="p">(),</span>
            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;Powell&quot;</span><span class="p">,</span>
            <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;xtol&quot;</span><span class="p">:</span> <span class="n">xtol</span><span class="p">,</span> <span class="s2">&quot;ftol&quot;</span><span class="p">:</span> <span class="n">ftol</span><span class="p">},</span>
        <span class="p">)</span>  <span class="c1"># , bounds=[(0.0,np.pi)])</span>

        <span class="k">def</span> <span class="nf">func2</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">z</span><span class="p">])</span>

        <span class="n">r2</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span>
            <span class="n">func2</span><span class="p">,</span>
            <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="p">(),</span>
            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;Powell&quot;</span><span class="p">,</span>
            <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;xtol&quot;</span><span class="p">:</span> <span class="n">xtol</span><span class="p">,</span> <span class="s2">&quot;ftol&quot;</span><span class="p">:</span> <span class="n">ftol</span><span class="p">},</span>
        <span class="p">)</span>  <span class="c1"># , bounds=[(0.0,np.pi)])</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">r1</span><span class="o">.</span><span class="n">fun</span><span class="p">),</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="n">r2</span><span class="o">.</span><span class="n">fun</span><span class="p">))</span></div>

<div class="viewcode-block" id="Elastic.shear3D"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.Elastic.shear3D">[docs]</a>    <span class="k">def</span> <span class="nf">shear3D</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">guess1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">guess2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">):</span>
        <span class="n">tol</span> <span class="o">=</span> <span class="mf">0.005</span>

        <span class="k">def</span> <span class="nf">func1</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">])</span>

        <span class="n">r1</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span>
            <span class="n">func1</span><span class="p">,</span> <span class="n">guess1</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;COBYLA&quot;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;tol&quot;</span><span class="p">:</span> <span class="n">tol</span><span class="p">}</span>
        <span class="p">)</span>  <span class="c1"># , bounds=[(0.0,np.pi)])</span>

        <span class="k">def</span> <span class="nf">func2</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">shear</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">])</span>

        <span class="n">r2</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span>
            <span class="n">func2</span><span class="p">,</span> <span class="n">guess2</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;COBYLA&quot;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;tol&quot;</span><span class="p">:</span> <span class="n">tol</span><span class="p">}</span>
        <span class="p">)</span>  <span class="c1"># , bounds=[(0.0,np.pi)])</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">r1</span><span class="o">.</span><span class="n">fun</span><span class="p">),</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="n">r2</span><span class="o">.</span><span class="n">fun</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">r1</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">r2</span><span class="o">.</span><span class="n">x</span><span class="p">))</span></div>

<div class="viewcode-block" id="Elastic.Poisson2D"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.Elastic.Poisson2D">[docs]</a>    <span class="k">def</span> <span class="nf">Poisson2D</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">ftol</span> <span class="o">=</span> <span class="mf">0.001</span>
        <span class="n">xtol</span> <span class="o">=</span> <span class="mf">0.01</span>

        <span class="k">def</span> <span class="nf">func1</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Poisson</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">z</span><span class="p">])</span>

        <span class="n">r1</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span>
            <span class="n">func1</span><span class="p">,</span>
            <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="p">(),</span>
            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;Powell&quot;</span><span class="p">,</span>
            <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;xtol&quot;</span><span class="p">:</span> <span class="n">xtol</span><span class="p">,</span> <span class="s2">&quot;ftol&quot;</span><span class="p">:</span> <span class="n">ftol</span><span class="p">},</span>
        <span class="p">)</span>  <span class="c1"># , bounds=[(0.0,np.pi)])</span>

        <span class="k">def</span> <span class="nf">func2</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Poisson</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">z</span><span class="p">])</span>

        <span class="n">r2</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span>
            <span class="n">func2</span><span class="p">,</span>
            <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="p">(),</span>
            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;Powell&quot;</span><span class="p">,</span>
            <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;xtol&quot;</span><span class="p">:</span> <span class="n">xtol</span><span class="p">,</span> <span class="s2">&quot;ftol&quot;</span><span class="p">:</span> <span class="n">ftol</span><span class="p">},</span>
        <span class="p">)</span>  <span class="c1"># , bounds=[(0.0,np.pi)])</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">r1</span><span class="o">.</span><span class="n">fun</span><span class="p">)),</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">r1</span><span class="o">.</span><span class="n">fun</span><span class="p">)),</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="n">r2</span><span class="o">.</span><span class="n">fun</span><span class="p">))</span></div>

<div class="viewcode-block" id="Elastic.poisson3D"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.Elastic.poisson3D">[docs]</a>    <span class="k">def</span> <span class="nf">poisson3D</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">guess1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">guess2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">):</span>
        <span class="n">tol</span> <span class="o">=</span> <span class="mf">0.005</span>

        <span class="k">def</span> <span class="nf">func1</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Poisson</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">])</span>

        <span class="n">r1</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span>
            <span class="n">func1</span><span class="p">,</span> <span class="n">guess1</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;COBYLA&quot;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;tol&quot;</span><span class="p">:</span> <span class="n">tol</span><span class="p">}</span>
        <span class="p">)</span>  <span class="c1"># , bounds=[(0.0,np.pi)])</span>

        <span class="k">def</span> <span class="nf">func2</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Poisson</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">])</span>

        <span class="n">r2</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span>
            <span class="n">func2</span><span class="p">,</span> <span class="n">guess2</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;COBYLA&quot;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;tol&quot;</span><span class="p">:</span> <span class="n">tol</span><span class="p">}</span>
        <span class="p">)</span>  <span class="c1"># , bounds=[(0.0,np.pi)])</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="nb">min</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">r1</span><span class="o">.</span><span class="n">fun</span><span class="p">)),</span>
            <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">r1</span><span class="o">.</span><span class="n">fun</span><span class="p">)),</span>
            <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="n">r2</span><span class="o">.</span><span class="n">fun</span><span class="p">),</span>
            <span class="nb">float</span><span class="p">(</span><span class="n">r1</span><span class="o">.</span><span class="n">x</span><span class="p">),</span>
            <span class="nb">float</span><span class="p">(</span><span class="n">r2</span><span class="o">.</span><span class="n">x</span><span class="p">),</span>
        <span class="p">)</span></div></div>


<div class="viewcode-block" id="ElasticOrtho"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.ElasticOrtho">[docs]</a><span class="k">class</span> <span class="nc">ElasticOrtho</span><span class="p">(</span><span class="n">Elastic</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An elastic tensor, for the specific case of an orthorhombic system&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize from a matrix, or from an Elastic object&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">Elastic</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">Elastic</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CVoigt</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">CVoigt</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SVoigt</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">SVoigt</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">Smat</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;ElasticOrtho constructor argument should be string or Elastic object&quot;</span>
            <span class="p">)</span>

<div class="viewcode-block" id="ElasticOrtho.Young"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.ElasticOrtho.Young">[docs]</a>    <span class="k">def</span> <span class="nf">Young</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">ct2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">st2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">ct2</span>
        <span class="n">cf2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">sf2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">cf2</span>
        <span class="n">s11</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">s22</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">s33</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">s44</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">s55</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">s66</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">s12</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">s13</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">s23</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span>
            <span class="n">ct2</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s33</span>
            <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">cf2</span> <span class="o">*</span> <span class="n">ct2</span> <span class="o">*</span> <span class="n">s13</span> <span class="o">*</span> <span class="n">st2</span>
            <span class="o">+</span> <span class="n">cf2</span> <span class="o">*</span> <span class="n">ct2</span> <span class="o">*</span> <span class="n">s55</span> <span class="o">*</span> <span class="n">st2</span>
            <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">ct2</span> <span class="o">*</span> <span class="n">s23</span> <span class="o">*</span> <span class="n">sf2</span> <span class="o">*</span> <span class="n">st2</span>
            <span class="o">+</span> <span class="n">ct2</span> <span class="o">*</span> <span class="n">s44</span> <span class="o">*</span> <span class="n">sf2</span> <span class="o">*</span> <span class="n">st2</span>
            <span class="o">+</span> <span class="n">cf2</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s11</span> <span class="o">*</span> <span class="n">st2</span> <span class="o">**</span> <span class="mi">2</span>
            <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">cf2</span> <span class="o">*</span> <span class="n">s12</span> <span class="o">*</span> <span class="n">sf2</span> <span class="o">*</span> <span class="n">st2</span> <span class="o">**</span> <span class="mi">2</span>
            <span class="o">+</span> <span class="n">cf2</span> <span class="o">*</span> <span class="n">s66</span> <span class="o">*</span> <span class="n">sf2</span> <span class="o">*</span> <span class="n">st2</span> <span class="o">**</span> <span class="mi">2</span>
            <span class="o">+</span> <span class="n">s22</span> <span class="o">*</span> <span class="n">sf2</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">st2</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="ElasticOrtho.LC"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.ElasticOrtho.LC">[docs]</a>    <span class="k">def</span> <span class="nf">LC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">ct2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">cf2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">s11</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">s22</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">s33</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">s12</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">s13</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">s23</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="mi">1000</span> <span class="o">*</span> <span class="p">(</span>
            <span class="n">ct2</span> <span class="o">*</span> <span class="p">(</span><span class="n">s13</span> <span class="o">+</span> <span class="n">s23</span> <span class="o">+</span> <span class="n">s33</span><span class="p">)</span>
            <span class="o">+</span> <span class="p">(</span><span class="n">cf2</span> <span class="o">*</span> <span class="p">(</span><span class="n">s11</span> <span class="o">+</span> <span class="n">s12</span> <span class="o">+</span> <span class="n">s13</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s12</span> <span class="o">+</span> <span class="n">s22</span> <span class="o">+</span> <span class="n">s23</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cf2</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ct2</span><span class="p">)</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="ElasticOrtho.shear"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.ElasticOrtho.shear">[docs]</a>    <span class="k">def</span> <span class="nf">shear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">ct</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">ct2</span> <span class="o">=</span> <span class="n">ct</span> <span class="o">*</span> <span class="n">ct</span>
        <span class="n">st2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">ct2</span>
        <span class="n">cf</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">sf</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">sf2</span> <span class="o">=</span> <span class="n">sf</span> <span class="o">*</span> <span class="n">sf</span>
        <span class="n">cx</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">cx2</span> <span class="o">=</span> <span class="n">cx</span> <span class="o">*</span> <span class="n">cx</span>
        <span class="n">sx</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">sx2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">cx2</span>
        <span class="n">s11</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">s22</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">s33</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">s44</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">s55</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">s66</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">s12</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">s13</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">s23</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">r</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">ct2</span> <span class="o">*</span> <span class="n">ct2</span> <span class="o">*</span> <span class="n">cx2</span> <span class="o">*</span> <span class="n">s44</span> <span class="o">*</span> <span class="n">sf2</span>
            <span class="o">+</span> <span class="n">cx2</span> <span class="o">*</span> <span class="n">s44</span> <span class="o">*</span> <span class="n">sf2</span> <span class="o">*</span> <span class="n">st2</span> <span class="o">*</span> <span class="n">st2</span>
            <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">cf</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">ct</span> <span class="o">*</span> <span class="n">cx</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">s11</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s12</span> <span class="o">+</span> <span class="n">s66</span><span class="p">)</span> <span class="o">*</span> <span class="n">sf</span> <span class="o">*</span> <span class="n">st2</span> <span class="o">*</span> <span class="n">sx</span>
            <span class="o">+</span> <span class="mi">2</span>
            <span class="o">*</span> <span class="n">cf</span>
            <span class="o">*</span> <span class="n">ct</span>
            <span class="o">*</span> <span class="n">cx</span>
            <span class="o">*</span> <span class="n">sf</span>
            <span class="o">*</span> <span class="p">(</span>
                <span class="n">ct2</span> <span class="o">*</span> <span class="p">(</span><span class="n">s44</span> <span class="o">-</span> <span class="n">s55</span><span class="p">)</span>
                <span class="o">+</span> <span class="p">(</span>
                    <span class="mi">4</span> <span class="o">*</span> <span class="n">s13</span>
                    <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">s23</span>
                    <span class="o">-</span> <span class="n">s44</span>
                    <span class="o">+</span> <span class="n">s55</span>
                    <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">s12</span> <span class="o">*</span> <span class="n">sf2</span>
                    <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">s22</span> <span class="o">*</span> <span class="n">sf2</span>
                    <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s66</span> <span class="o">*</span> <span class="n">sf2</span>
                <span class="p">)</span>
                <span class="o">*</span> <span class="n">st2</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="n">sx</span>
            <span class="o">+</span> <span class="n">s66</span> <span class="o">*</span> <span class="n">sf2</span> <span class="o">*</span> <span class="n">sf2</span> <span class="o">*</span> <span class="n">st2</span> <span class="o">*</span> <span class="n">sx2</span>
            <span class="o">+</span> <span class="n">cf</span> <span class="o">**</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">st2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">ct2</span> <span class="o">*</span> <span class="n">cx2</span> <span class="o">*</span> <span class="n">s11</span> <span class="o">+</span> <span class="n">s66</span> <span class="o">*</span> <span class="n">sx2</span><span class="p">)</span>
            <span class="o">+</span> <span class="n">ct2</span>
            <span class="o">*</span> <span class="p">(</span>
                <span class="mi">2</span> <span class="o">*</span> <span class="n">cx2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">s33</span> <span class="o">+</span> <span class="n">sf2</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">4</span> <span class="o">*</span> <span class="n">s23</span> <span class="o">-</span> <span class="n">s44</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s22</span> <span class="o">*</span> <span class="n">sf2</span><span class="p">))</span> <span class="o">*</span> <span class="n">st2</span>
                <span class="o">+</span> <span class="n">s55</span> <span class="o">*</span> <span class="n">sf2</span> <span class="o">*</span> <span class="n">sx2</span>
            <span class="p">)</span>
            <span class="o">+</span> <span class="n">cf</span> <span class="o">**</span> <span class="mi">2</span>
            <span class="o">*</span> <span class="p">(</span>
                <span class="n">ct2</span> <span class="o">*</span> <span class="n">ct2</span> <span class="o">*</span> <span class="n">cx2</span> <span class="o">*</span> <span class="n">s55</span>
                <span class="o">+</span> <span class="n">ct2</span>
                <span class="o">*</span> <span class="p">(</span>
                    <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">cx2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">s13</span> <span class="o">+</span> <span class="n">s55</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">s12</span> <span class="o">+</span> <span class="n">s66</span><span class="p">)</span> <span class="o">*</span> <span class="n">sf2</span><span class="p">)</span> <span class="o">*</span> <span class="n">st2</span>
                    <span class="o">+</span> <span class="n">s44</span> <span class="o">*</span> <span class="n">sx2</span>
                <span class="p">)</span>
                <span class="o">+</span> <span class="n">st2</span>
                <span class="o">*</span> <span class="p">(</span>
                    <span class="n">cx2</span> <span class="o">*</span> <span class="n">s55</span> <span class="o">*</span> <span class="n">st2</span>
                    <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">s11</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">s12</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s22</span> <span class="o">-</span> <span class="n">s66</span><span class="p">)</span> <span class="o">*</span> <span class="n">sf2</span> <span class="o">*</span> <span class="n">sx2</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">r</span></div>

<div class="viewcode-block" id="ElasticOrtho.Poisson"><a class="viewcode-back" href="../../../mechelastic.core.html#mechelastic.core.ELATE.ElasticOrtho.Poisson">[docs]</a>    <span class="k">def</span> <span class="nf">Poisson</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">ct</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">ct2</span> <span class="o">=</span> <span class="n">ct</span> <span class="o">*</span> <span class="n">ct</span>
        <span class="n">st2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">ct2</span>
        <span class="n">cf</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">sf</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">cx</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">sx</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">s11</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">s22</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">s33</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">s44</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">s55</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">s66</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">s12</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">s13</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">s23</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Smat</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="o">-</span><span class="p">(</span><span class="n">ct</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">cx</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s33</span> <span class="o">*</span> <span class="n">st2</span><span class="p">)</span>
            <span class="o">-</span> <span class="n">cf</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">cx</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s13</span> <span class="o">*</span> <span class="n">st2</span> <span class="o">*</span> <span class="n">st2</span>
            <span class="o">-</span> <span class="n">cx</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s23</span> <span class="o">*</span> <span class="n">sf</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">st2</span> <span class="o">*</span> <span class="n">st2</span>
            <span class="o">+</span> <span class="n">ct</span> <span class="o">*</span> <span class="n">cx</span> <span class="o">*</span> <span class="n">s44</span> <span class="o">*</span> <span class="n">sf</span> <span class="o">*</span> <span class="n">st2</span> <span class="o">*</span> <span class="p">(</span><span class="n">ct</span> <span class="o">*</span> <span class="n">cx</span> <span class="o">*</span> <span class="n">sf</span> <span class="o">+</span> <span class="n">cf</span> <span class="o">*</span> <span class="n">sx</span><span class="p">)</span>
            <span class="o">-</span> <span class="n">ct</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s23</span> <span class="o">*</span> <span class="p">(</span><span class="n">ct</span> <span class="o">*</span> <span class="n">cx</span> <span class="o">*</span> <span class="n">sf</span> <span class="o">+</span> <span class="n">cf</span> <span class="o">*</span> <span class="n">sx</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
            <span class="o">-</span> <span class="n">cf</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s12</span> <span class="o">*</span> <span class="n">st2</span> <span class="o">*</span> <span class="p">(</span><span class="n">ct</span> <span class="o">*</span> <span class="n">cx</span> <span class="o">*</span> <span class="n">sf</span> <span class="o">+</span> <span class="n">cf</span> <span class="o">*</span> <span class="n">sx</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
            <span class="o">-</span> <span class="n">s22</span> <span class="o">*</span> <span class="n">sf</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">st2</span> <span class="o">*</span> <span class="p">(</span><span class="n">ct</span> <span class="o">*</span> <span class="n">cx</span> <span class="o">*</span> <span class="n">sf</span> <span class="o">+</span> <span class="n">cf</span> <span class="o">*</span> <span class="n">sx</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
            <span class="o">+</span> <span class="n">cf</span> <span class="o">*</span> <span class="n">ct</span> <span class="o">*</span> <span class="n">cx</span> <span class="o">*</span> <span class="n">s55</span> <span class="o">*</span> <span class="n">st2</span> <span class="o">*</span> <span class="p">(</span><span class="n">cf</span> <span class="o">*</span> <span class="n">ct</span> <span class="o">*</span> <span class="n">cx</span> <span class="o">-</span> <span class="n">sf</span> <span class="o">*</span> <span class="n">sx</span><span class="p">)</span>
            <span class="o">-</span> <span class="n">cf</span> <span class="o">*</span> <span class="n">s66</span> <span class="o">*</span> <span class="n">sf</span> <span class="o">*</span> <span class="n">st2</span> <span class="o">*</span> <span class="p">(</span><span class="n">ct</span> <span class="o">*</span> <span class="n">cx</span> <span class="o">*</span> <span class="n">sf</span> <span class="o">+</span> <span class="n">cf</span> <span class="o">*</span> <span class="n">sx</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">cf</span> <span class="o">*</span> <span class="n">ct</span> <span class="o">*</span> <span class="n">cx</span> <span class="o">-</span> <span class="n">sf</span> <span class="o">*</span> <span class="n">sx</span><span class="p">)</span>
            <span class="o">-</span> <span class="n">ct</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s13</span> <span class="o">*</span> <span class="p">(</span><span class="n">cf</span> <span class="o">*</span> <span class="n">ct</span> <span class="o">*</span> <span class="n">cx</span> <span class="o">-</span> <span class="n">sf</span> <span class="o">*</span> <span class="n">sx</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
            <span class="o">-</span> <span class="n">cf</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s11</span> <span class="o">*</span> <span class="n">st2</span> <span class="o">*</span> <span class="p">(</span><span class="n">cf</span> <span class="o">*</span> <span class="n">ct</span> <span class="o">*</span> <span class="n">cx</span> <span class="o">-</span> <span class="n">sf</span> <span class="o">*</span> <span class="n">sx</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
            <span class="o">-</span> <span class="n">s12</span> <span class="o">*</span> <span class="n">sf</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">st2</span> <span class="o">*</span> <span class="p">(</span><span class="n">cf</span> <span class="o">*</span> <span class="n">ct</span> <span class="o">*</span> <span class="n">cx</span> <span class="o">-</span> <span class="n">sf</span> <span class="o">*</span> <span class="n">sx</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="n">ct</span> <span class="o">**</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">s33</span>
            <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">cf</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">ct</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s13</span> <span class="o">*</span> <span class="n">st2</span>
            <span class="o">+</span> <span class="n">cf</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">ct</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s55</span> <span class="o">*</span> <span class="n">st2</span>
            <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">ct</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s23</span> <span class="o">*</span> <span class="n">sf</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">st2</span>
            <span class="o">+</span> <span class="n">ct</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s44</span> <span class="o">*</span> <span class="n">sf</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">st2</span>
            <span class="o">+</span> <span class="n">cf</span> <span class="o">**</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">s11</span> <span class="o">*</span> <span class="n">st2</span> <span class="o">*</span> <span class="n">st2</span>
            <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">cf</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s12</span> <span class="o">*</span> <span class="n">sf</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">st2</span> <span class="o">*</span> <span class="n">st2</span>
            <span class="o">+</span> <span class="n">cf</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s66</span> <span class="o">*</span> <span class="n">sf</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">st2</span> <span class="o">*</span> <span class="n">st2</span>
            <span class="o">+</span> <span class="n">s22</span> <span class="o">*</span> <span class="n">sf</span> <span class="o">**</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">st2</span> <span class="o">*</span> <span class="n">st2</span>
        <span class="p">)</span></div></div>


<span class="c1">#########################################################################################</span>
<span class="c1"># Data genertaation</span>
<span class="c1">################################################################################################</span>
<span class="c1"># ELATE : basic usage of the tool, only 2D plots</span>
<span class="c1"># YOUNG3D : visualize Young&#39;s modulus in 3D</span>
<span class="c1"># LC3D : visualize Linear compressiblity in 3D</span>
<span class="c1"># SHEAR3D : visualize Shear modulus in 3D</span>
<span class="c1"># POISSON3D : visualize Poisson ratio in 3D</span>
<span class="c1">################################################################################################</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Sobhit Singh

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>